workflows:
  vite_capacitor_build:
    name: MyFocus Android Build
    environment:
      node: 20
    scripts:
      - echo "ğŸ“¦ Installing dependenciesâ€¦"
      - npm install

      - echo "ğŸ”§ Building Vite frontendâ€¦"
      - npm run build

      - echo "â• Adding Android platform if missingâ€¦"
      - if [ ! -d "./android" ]; then npx cap add android; fi

      - echo "ğŸ”„ Syncing Capacitor platformâ€¦"
      - npx cap sync android

      - echo "ğŸ“¥ Setting up Gradle"
      - cd android
      - |
        GRADLE_VERSION=8.7
        wget https://services.gradle.org/distributions/gradle-${GRADLE_VERSION}-bin.zip
        unzip gradle-${GRADLE_VERSION}-bin.zip -d gradle
        export PATH=$PWD/gradle/gradle-${GRADLE_VERSION}/bin:$PATH
        gradle -v

      - echo "ğŸ— Assembling Debug APK"
      - gradle assembleDebug

    artifacts:
      - android/app/build/outputs/**/*.apk
